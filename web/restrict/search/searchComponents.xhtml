<ui:composition template="/WEB-INF/templates/layout.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui">
    <ui:define name="content">
        <h2 class="page-header">Search Components</h2>

        <p:ajaxStatus onstart="PF('statusDialog').show()" onsuccess="PF('statusDialog').hide()" />
        <p:dialog widgetVar="statusDialog" modal="true" draggable="false" closable="false" resizable="false" showHeader="false">
            <p:graphicImage name="/images/ajax-loader.gif" />
        </p:dialog>

        <h:form id="searchComponentsForm">
            <p:growl id="growl" />
            <p:panel header="Search in Repositories" style="margin: 10px 0;">
                <p:messages id="messages" />
                <p:selectManyCheckbox id="basic" value="#{searchComponents.selectedComponents}">
                    <f:selectItem itemLabel="Files" itemValue="file"/>
                    <f:selectItem itemLabel="Packs" itemValue="pack" />
                    <f:selectItem itemLabel="Services" itemValue="service" />     
                    <f:selectItem itemLabel="Workflows" itemValue="workflow" />
                </p:selectManyCheckbox>                    
                <h:panelGrid columns="3" cellpadding="4">
                    <h:outputLabel for="searchTerm" value="Enter your search term: " />
                    <p:inputText id="searchTerm" 
                                 value="#{searchComponents.searchQuery}" 
                                 required="true" 
                                 label="SearchTerm"
                                 size="50">
                        <f:validateLength minimum="4" />
                    </p:inputText>
                    <p:message for="searchTerm" />    
                </h:panelGrid>

                <p:accordionPanel>                
                    <p:tab title="Prime Search - Syntactic">
                        <h:panelGrid columns="2" style="margin-bottom:10px" cellpadding="10">
                            <h:outputLabel for="hasAddress" value="Address: " />
                            <h:inputText 
                                id="hasAddress"/>                        
                            <h:outputLabel for="hasReturn" value="Return:" />
                            <h:inputText 
                                id="hasReturn"/>                  
                        </h:panelGrid>
                    </p:tab>
                    <p:tab title="Prime Search - Semantic">
                        <h:panelGrid columns="2" style="margin-bottom:10px" cellpadding="10">
                            <h:outputLabel for="hasSemanticReturn" value="Semantic Return" />
                            <h:inputText id="hasSemanticReturn"/>             
                            <h:outputLabel for="hasSemanticReception" value="Semantic Reception" />
                            <h:inputText id="hasSemanticReception"/>
                            <h:outputLabel for="hasSemanticRepresentation" value="Semantic Representation" />
                            <h:inputText id="hasSemanticRepresentation"/>
                            <h:outputLabel for="hasFunctionalRequirement" value="Functional Requirement" />
                            <h:inputText id="hasFunctionalRequirement"/>
                        </h:panelGrid>
                    </p:tab>
                    <p:tab title="Prime Search - Pragmatic">
                        <h:panelGrid columns="2" style="margin-bottom:10px" cellpadding="10">
                            <h:outputLabel for="hasNonFunctionalReq" value="Non Functional Requirement" />
                            <h:inputText id="hasNonFunctionalReq"/>
                            <h:outputLabel value="Context" for="serviceDescriptionVO" styleClass="panelGridLabel"/>
                            <h:outputLabel value="" for="serviceDescriptionVO" styleClass="panelGridLabel"/>
                            <h:outputLabel for="hasArtifact" value="Artifact" />
                            <h:inputText id="hasArtifact"/>
                            <h:outputLabel for="hasDomain" value="Domain" />
                            <h:inputText id="hasDomain"/>
                            <h:outputLabel for="hasLicense" value="License" />
                            <h:inputText id="hasLicense"/>
                            <h:outputLabel for="hasComments" value="Comments" />
                            <h:inputText id="hasComments"/>
                            <h:outputLabel for="how" value="Purpose" />
                            <h:inputText id="how"/>
                            <h:outputLabel for="where" value="Provider" />
                            <h:inputText id="where"/>
                            <h:outputLabel for="when" value="Publication Data" />
                            <h:inputText id="when"/>
                            <h:outputLabel for="who" value="Scientist Name" />
                            <h:inputText id="who"/>
                            <h:outputLabel for="hasRestriction" value="Restriction" />
                            <h:inputText id="hasRestriction"/>
                            <h:outputLabel value="Hardware" for="serviceDescriptionVO" styleClass="panelGridLabel"/>
                            <h:outputLabel value="" for="serviceDescriptionVO" styleClass="panelGridLabel"/>
                            <h:outputLabel for="hasCPU" value="CPU" />
                            <h:inputText id="hasCPU"/>
                            <h:outputLabel for="hasOperationalSystem" value="Operational System" />
                            <h:inputText id="hasOperationalSystem"/>
                            <h:outputLabel for="hasRAM" value="RAM (GB)" />
                            <h:inputText id="hasRAM">
                                <f:validateRegex pattern="[0-9]*"/>
                            </h:inputText>
                            <h:outputLabel for="hasROM" value="ROM (GB)"/>
                            <h:inputText id="hasROM" >
                                <f:validateRegex pattern="[0-9]*"/>
                            </h:inputText>    
                        </h:panelGrid>
                    </p:tab>

                </p:accordionPanel>

                <p:commandButton value="Search" icon="ui-icon-search" 
                                 actionListener="#{searchComponents.search()}" 
                                 update="searchResults"    />
            </p:panel>
            <p:panel header="Results" style="margin: 10px 0;">
                <p:dataTable var="result" value="#{searchComponents.patternResults}" 
                             id="searchResults" emptyMessage="No records found"
                             paginatorTemplate="{RowsPerPageDropdown} {CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}"
                             paginator="true" rows="3" rowsPerPageTemplate="5,10,25,50,100,9999"
                             style="margin-top: 20px">
                    <p:column headerText="Component Name" sortBy="#{result.name}">
                        <h:outputText value="#{result.name}" />
                    </p:column>
                    <p:column headerText="Repository Name" sortBy="#{result.repositoryName}">
                        <h:outputText value="#{result.repositoryName}" />
                    </p:column>
                    <p:column headerText="Component Type" sortBy="#{result.componentType}">
                        <h:outputText value="#{result.componentType}" />
                    </p:column>                    
                    <p:column headerText="Description" sortBy="#{result.description}">
                        <h:outputText value="#{result.description.length() gt 100 ? result.description.substring(0,97).concat('...') : result.description}" title="#{result.description}"/>
                    </p:column>
                    <p:column headerText="Owner">
                        <h:outputText value="#{result.owner}"/>
                    </p:column>
                    <p:column headerText="Component Documentation" style="text-align: center">
                        <p:commandButton value="More Details" onclick="PF('dlg3').show();"/>
                        <p:dialog header="Components " widgetVar="dlg3" showEffect="explode" modal="true" height="100">
                            <p:dataTable var="componentData" value="#{result}">
                                <p:column headerText="Id">
                                    <h:outputText value="1" />
                                </p:column>
                                <p:column headerText="Year">
                                    <h:outputText value="#{result.owner}" />
                                </p:column>

                                <p:column headerText="Brand">
                                    <h:outputText value="1" />
                                </p:column>

                                <p:column headerText="Color">
                                    <h:outputText value="azul" />
                                </p:column>
                            </p:dataTable>


                        </p:dialog>                        
                        <p:commandButton value="Download" ajax="false" icon="ui-icon-arrowthick-1-s"
                                         action="#{result.createServiceFile(result.serviceIdRepository)}">
                            <p:fileDownload value="#{result.file}" />
                        </p:commandButton>
                    </p:column>                    
                </p:dataTable>
            </p:panel>
        </h:form>
    </ui:define>
</ui:composition>